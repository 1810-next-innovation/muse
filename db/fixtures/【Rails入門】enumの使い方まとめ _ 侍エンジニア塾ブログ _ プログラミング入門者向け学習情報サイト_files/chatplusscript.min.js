!function(n){var l=function(t){var a="",e="";return 0<document.cookie.length&&-1!=(a=document.cookie.indexOf(t+"="))?(a=a+t.length+1,-1==(e=document.cookie.indexOf(";",a))&&(e=document.cookie.length),unescape(document.cookie.substring(a,e))):""},s=function(t){if(location.protocol+"//"+location.hostname===__cp_d&&/^\/chat\/visitor\//.test(location.pathname))switch(t.type){case"edit-lead":t.params.accessToken=t.token,t.params.siteId=t.siteId,t.params.token=t.vtoken,jQueryPlus.ajax({type:"POST",url:"/api/v1/update_user",data:t.params}).done(function(t,a,e){_chatplusscript_updateUser_callback&&(_chatplusscript_updateUser_callback.call(this,t),_chatplusscript_updateUser_callback=null)}).fail(function(t,a,e){_chatplusscript_updateUser_callback&&(_chatplusscript_updateUser_callback.call(this,{result:-1,code:t.status}),_chatplusscript_updateUser_callback=null)});break;case"get-lead-one":jQueryPlus.ajax({type:"POST",url:"/api/v1/get_lead_one",data:{accessToken:t.token,siteId:t.siteId,token:t.vtoken}}).done(function(t,a,e){_chatplusscript_getLeadOne_callback&&(_chatplusscript_getLeadOne_callback.call(this,t),_chatplusscript_getLeadOne_callback=null)}).fail(function(t,a,e){_chatplusscript_getLeadOne_callback&&(_chatplusscript_getLeadOne_callback.call(this,{result:-1,code:t.status}),_chatplusscript_getLeadOne_callback=null)});break;case"get-visitor-option":var a="chatplus_visitor_option_"+t.access_key;if(new RegExp("(?:^|;\\s*)"+escape(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(window.document.cookie)){var e=unescape(window.document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1"));JSON.parse(e)}window.chatplus.option=t.option}else{var c=document.getElementById("jp.chatplus.app_chat_frame");c?c.contentWindow.postMessage(t,"*"):console.error("iframe#jp.chatplus.app_chat_frame not found.")}};n.ChatplusScript={},n._chatplusscript_updateUser_callback=null,n._chatplusscript_getLeadOne_callback=null,ChatplusScript.updateUser=function(t,a,e,c){n._chatplusscript_updateUser_callback=c||null;var i=setInterval(function(t){clearInterval(i);t={type:"edit-lead",token:t.token,siteId:t.siteId,params:t.params};l("jp_chatplus_vtoken")&&(t.vtoken=l("jp_chatplus_vtoken")),s(t)},300,{token:t,siteId:a,params:e})},ChatplusScript.getLead=function(a,e,t){n._chatplusscript_getLeadOne_callback=t;var c=setInterval(function(t){clearInterval(c);t={type:"get-lead-one",token:a,siteId:e};l("jp_chatplus_vtoken")&&(t.vtoken=l("jp_chatplus_vtoken")),s(t)},300,{token:a,siteId:e})},ChatplusScript.openChat=function(){var t=document.querySelector("#chatplusview #openChat");t&&t.click()},ChatplusScript.closeChat=function(){var t=document.querySelector("#chatplusview #closeChat");t&&t.click()},n.ChatplusAppScript={},ChatplusAppScript.getLead=function(t,a,c){var e=setInterval(function(t){clearInterval(e),t.visitorId=va,jQueryPlus.ajax({type:"POST",url:__cp_d+"/api/v1/get_visitor_one",data:t}).done(function(t,a,e){c.call(this,t)}).fail(function(t,a,e){c.call(this,{result:-1,errorCode:t.status})})},300,{accessToken:t,siteId:a,option:1})},n.ChatplusAction={},ChatplusAction.addVisitorTag=function(t,a,e,c){var i=null;arguments[4]&&(i=arguments[4]),jQueryPlus.ajax({url:__cp_d+"/api/action/addvisitortag",method:"POST",data:{key:t+"_"+a,visitorId:e,tags:JSON.stringify(c)}}).done(function(t){i&&i.call(this,t)}).fail(function(){i&&i.call(this,data)})},ChatplusAction.addVisitorAttribute=function(t,a,e,c){var i=null;arguments[4]&&(i=arguments[4]),jQueryPlus.ajax({url:__cp_d+"/api/action/addvisitorattribute",method:"POST",data:{key:t+"_"+a,visitorId:e,attrs:JSON.stringify(c)}}).done(function(t){i&&i.call(this,t)}).fail(function(){i&&i.call(this,data)})},ChatplusAction.addVisitorAttributeEx=function(t,a,e,c){var i=null;arguments[4]&&(i=arguments[4]),jQueryPlus.ajax({url:__cp_d+"/api/action/addvisitorattribute",method:"POST",data:{key:t+"_"+a,visitorId:e,attrs:JSON.stringify(c),ex:!0}}).done(function(t){i&&i.call(this,t)}).fail(function(){i&&i.call(this,data)})},ChatplusAction.addAgentTag=function(t,a,e,c){var i=null;arguments[4]&&(i=arguments[4]),jQueryPlus.ajax({url:__cp_d+"/api/action/addagenttag",method:"POST",data:{key:t+"_"+a,agentId:e,tags:JSON.stringify(c)}}).done(function(t){i&&i.call(this,t)}).fail(function(){i&&i.call(this,data)})},ChatplusAction.addChatTag=function(t,a,e,c){var i=null;arguments[4]&&(i=arguments[4]),jQueryPlus.ajax({url:__cp_d+"/api/action/addchattag",method:"POST",data:{key:t+"_"+a,chatId:e,tags:JSON.stringify(c)}}).done(function(t){i&&i.call(this,t)}).fail(function(){i&&i.call(this,data)})},ChatplusAction.postback=function(t,a,e,c){var i=null;arguments[4]&&(i=arguments[4]),jQueryPlus.ajax({url:__cp_d+"/api/action/postback",method:"POST",data:{key:t+"_"+a,visitorId:e,params:JSON.stringify(c)}}).done(function(t){i&&i.call(this,t)}).fail(function(){i&&i.call(this,data)})},ChatplusAction.getChatInfo=function(t,a,e,c){jQueryPlus.ajax({url:__cp_d+"/api/action/getchatinfo",method:"POST",data:{key:t+"_"+a,chatId:e}}).done(function(t){c&&c.call(this,t)}).fail(function(){})},"freeze"in Object&&(Object.freeze(ChatplusScript),Object.freeze(ChatplusAppScript),Object.freeze(ChatplusAction))}(window);
//# sourceMappingURL=chatplusscript.min.js.map