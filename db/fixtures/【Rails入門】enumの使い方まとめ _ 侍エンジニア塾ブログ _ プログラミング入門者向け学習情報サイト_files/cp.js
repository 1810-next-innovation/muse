var jp_chatplus_app_accessTime,chatviewDiv=null,chatviewDivFooter=null,jpChatplusOnComplete=!1,referer=location.href!=parent.location.href?parent.document.referrer:document.referrer,requestUrl=location.protocol+"//"+location.host+location.pathname+location.search,userAgent=navigator.userAgent.toLowerCase(),__cp_c=document.__cp_c;__cp_d=document.__cp_d,__cp_t=document.__cp_t,__cp_p=document.__cp_p,__cp_p&&"object"==typeof __cp_p&&(__cp_p=JSON.stringify(__cp_p)),__cp_f=document.__cp_f,__cp_f&&"object"==typeof __cp_f&&(__cp_f=JSON.stringify(__cp_f)),addScript(document.getElementsByTagName("body").item(0),__cp_d+"/assets/js/app/chatplusscript.min.js?v="+parseInt((new Date).getTime()/9e5)),window.onbeforeunload=function(){__cp_tracker.sendServer(!0)},browser={Version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],Safari:/webkit/.test(userAgent),Opera:/opera/.test(userAgent),IE:/msie/.test(userAgent)&&!/opera/.test(userAgent),Mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent),Chrome:/chrome/.test(userAgent)},Tracker=function(){return this.accessTime=(new Date).getTime(),this.xmlHttp=null,this},Tracker.prototype={accessTime:null,xmlHttp:null,getTitle:function(){if(document.getElementById("title")){var e=document.getElementsByTagName("title")[0];return browser.IE?e.innerHTML:e.firstChild.nodeValue}return document.title},displayChat:function(){for(var e=document.cookie.split(";"),t=[],a=0;a<e.length;a++){e[a]=e[a].replace(/^ +| +$/,"");var n=e[a].split("=");t[n[0]]=n[1]}var i="";if(this.getCookie("jp_chatplus_vtoken"))i=this.getCookie("jp_chatplus_vtoken");else{var r="abcdefghijklmnopqrstuvwxyz0123456789",o=r.length;for(a=0;a<20;a++)i+=r[Math.floor(Math.random()*o)];i+=__cp_c.split("_")[0],this.setCookie("jp_chatplus_vtoken",i)}var c="c";__cp_t&&(c=__cp_t);-1!=(s=window.navigator.userAgent.toLowerCase()).indexOf("windows")&&-1!=s.indexOf("touch")&&-1==s.indexOf("tablet pc")||-1!=s.indexOf("ipad")||-1!=s.indexOf("android")&&-1==s.indexOf("mobile")||-1!=s.indexOf("firefox")&&-1!=s.indexOf("tablet")||-1!=s.indexOf("kindle")||-1!=s.indexOf("silk")||s.indexOf("playbook"),-1!=s.indexOf("windows")&&-1!=s.indexOf("phone")||-1!=s.indexOf("iphone")||-1!=s.indexOf("ipod")||-1!=s.indexOf("android")&&-1!=s.indexOf("mobile")||-1!=s.indexOf("firefox")&&-1!=s.indexOf("mobile")||s.indexOf("blackberry");var s,p=__cp_d+"/chat/visitor/";p+=__cp_c+"/"+c,p+="?pt="+encodeURIComponent(this.getTitle()),p+="&pu="+encodeURIComponent(location.protocol+"//"+location.host+location.pathname+location.search),p+="&pr="+encodeURIComponent(document.referrer),p+="&c="+i,__cp_p&&(p+="&pp="+encodeURIComponent(__cp_p)),__cp_f&&(p+="&pf="+encodeURIComponent(__cp_f)),navigator.cookieEnabled||(p+="&fp="+new Fingerprint({canvas:!0,screen_resolution:!0}).get());var l="UTF-8";"UTF-8"!=(l=document.all?document.charset:document.characterSet)&&"utf-8"!=l&&(p+="&pc="+l);this.accessTime;createScriptAfterRequire("https://appimg.chatplus.jp/app/s/lib/jqueryc.min.js","jQueryPlus"),createScriptAfterRequire("https://appimg.chatplus.jp/app/s/lib/riot/2.6.4/riot%2Bcompiler.min.js","riot"),createScriptAfterRequire("https://appimg.chatplus.jp/app/s/lib/underscore/underscorec.min.js","underscore"),createIframe({id:"jp.chatplus.app_chat_frame",src:p+"#"+JSON.stringify({accessTime:this.accessTime}),style:"display:none",frameborder:"no"}),jp_chatplus_app_accessTime=this.accessTime},nl2br:function(e){return e.replace(/(\r\n|\r|\n)/g,"<br />")},readyLead:function(){createScriptAfter(__cp_d+"/assets/js/app/lead.min.js"),createStyle(__cp_d+"/assets/css/lead.min.css")},displayLead:function(){window.chatplus&&window.chatplus.displayLead||this.readyLead(),window.chatplus.displayLead()},sendServer:function(e){var t=Math.floor(t/1e3),a=__cp_d+"/chat/track/";if(a+=__cp_c+"/c",a+="?pt="+encodeURIComponent(this.getTitle()),a+="&pu="+encodeURIComponent(location.protocol+"//"+location.host+location.pathname+location.search),a+="&jt="+t,a+="&s="+Math.floor(100*Math.random()),e){var n=document.getElementById("item"),i=n||document.getElementsByTagName("body").item(0),r=document.createElement("img");r.setAttribute("src",a),i.appendChild(r)}else document.write('<img src="'+a+'" />');return this},ajax:function(e,t,a){window.XMLHttpRequest?this.xmlHttp=new XMLHttpRequest:window.ActiveXObject?this.xmlHttp=new ActiveXObject("Microsoft.XMLHTTP"):this.xmlHttp=null;var n=this;this.xmlHttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&a.call(n,this.responseText)},this.xmlHttp.open("POST",e),this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xmlHttp.send(this.encodeHTMLForm(t))},encodeHTMLForm:function(e){var t=[];for(var a in e){var n=e[a],i=encodeURIComponent(a)+"="+encodeURIComponent(n);t.push(i)}return t.join("&").replace(/%20/g,"+")},setCookie:function(e,t){path="/";var a=(new Date).getTime(),n=new Date(a+63072e7).toUTCString(),i="";i+=e+"="+escape(t),i+="; path="+path,i+="; expires="+n+"; ",document.cookie=i},getCookie:function(e){var t="",a="";return 0<document.cookie.length&&-1!=(t=document.cookie.indexOf(e+"="))?(t=t+e.length+1,-1==(a=document.cookie.indexOf(";",t))&&(a=document.cookie.length),unescape(document.cookie.substring(t,a))):""},removeCookie:function(e){var t="";t+=e+"=",t+="; path=/",t+="; expires=Thu, 01 Jan 1970 00:00:00 GMT; ",document.cookie=t}};var __cp_tracker=new Tracker,__cp_design=null,__cp_leadTime=0,__cp_vi=null;function loadStartChat(e){var t=document.getElementsByTagName("body").item(0);createAudioTag("message",t,"audioTypeMessage"),createAudioTag("start",t,"audioTypeStart"),createStyle("https://appimg.chatplus.jp/app/s/lib/font-awesome-5.2.0/css/all-cp.min.css?"),createStyle(__cp_d+"/assets/css/chat_common.min.css?v="+e.version),createStyle(__cp_d+"/assets/css/chat.min.css?v="+e.version);var a,n={Tablet:-1!=(a=window.navigator.userAgent.toLowerCase()).indexOf("windows")&&-1!=a.indexOf("touch")&&-1==a.indexOf("tablet pc")||-1!=a.indexOf("ipad")||-1!=a.indexOf("android")&&-1==a.indexOf("mobile")||-1!=a.indexOf("firefox")&&-1!=a.indexOf("tablet")||-1!=a.indexOf("kindle")||-1!=a.indexOf("silk")||-1!=a.indexOf("playbook"),Mobile:-1!=a.indexOf("windows")&&-1!=a.indexOf("phone")||-1!=a.indexOf("iphone")||-1!=a.indexOf("ipod")||-1!=a.indexOf("android")&&-1!=a.indexOf("mobile")||-1!=a.indexOf("firefox")&&-1!=a.indexOf("mobile")||-1!=a.indexOf("blackberry")};(n.Mobile||n.Tablet)&&createStyle(__cp_d+"/assets/css/chat_sp.min.css?v="+e.version);var i=document.getElementsByTagName("head")[0],r=document.createElement("style");r.innerHTML=e.style,i.appendChild(r);var o=document.createElement("chat");t.appendChild(o);var c=document.createElement("script");c.id="chat_config",c.type="application/json",c.innerText=JSON.stringify(e.configChat),t.appendChild(c);var s=document.createElement("script");s.innerHTML=e.configKey,t.appendChild(s),addScript(t,__cp_d+"/assets/js/riot-tags/output.tag.js?v="+e.version,{type:"riot/tag"}),addScript(t,__cp_d+"/assets/js/riot-tags/chat.tag.js?v="+e.version,{type:"riot/tag"}),addScript(t,__cp_d+"/assets/js/app/visitor-client.min.js?v="+e.version),"undefined"==typeof jQueryPlus&&addScript(t,"https://appimg.chatplus.jp/app/s/lib/jqueryc.min.js"),e.configChat.externals&&e.configChat.externals.pardot&&e.configChat.externals.pardot.enabled&&jQueryPlus.getScript(__cp_d+"/assets/js/app/external/pardot.min.js").then(function(){e.configChat.externals.pardot.landing_url&&window.chatplus.create_pardot_landing(e.configChat),e.configChat.externals.pardot.form_url&&window.chatplus.create_pardot_form(e.configChat)}),jpChatplusOnComplete=!0}function createScriptAfter(e,t){var a=document.createElement("script"),n=document.getElementsByTagName("script")[0];t&&(a.type=t),a.src=e,n.parentNode.insertBefore(a,n.nextSibling)}function createScriptBefore(e,t){var a=document.createElement("script"),n=document.getElementsByTagName("script")[0];t&&(a.type=t),a.src=e,n.parentNode.insertBefore(a,n)}function createStyle(e){var t=document.createElement("link"),a=document.getElementsByTagName("head")[0];t.setAttribute("rel","stylesheet"),t.href=e,a.appendChild(t)}function createStyleAttribute(e,t){var a=document.createElement("link"),n=document.getElementsByTagName("head")[0];a.setAttribute("rel","stylesheet"),a.setAttribute("integrity",t),a.setAttribute("crossorigin","anonymous"),a.href=e,n.appendChild(a)}function createAudioTag(e,t,a){var n=document.createElement("audio");n.id=a,n.innerHTML='<source src="https://appimg.chatplus.jp/app/s/sound/'+e+'.mp3" type="audio/mp3">',t.appendChild(n)}function createScriptAfterRequire(e,t){var a=document.createElement("script"),n=document.getElementsByTagName("body").item(0);a.setAttribute("charset","utf-8"),a.setAttribute("async",""),a.setAttribute("data-requirecontext","_"),a.setAttribute("data-requiremodule",t),a.type="text/javascript",a.src=e,n.appendChild(a)}function addScript(e,t,a){var n=document.createElement("script");if(n.src=t,a)for(var i in a)n.setAttribute(i,a[i]);e.appendChild(n)}function createIframe(e){var t=document.getElementsByTagName("body").item(0),a=document.createElement("iframe");if(e)for(var n in e)a.setAttribute(n,e[n]);t.appendChild(a)}window.addEventListener("message",function(a){chatviewDiv=document.getElementById("chatplusview"),chatviewDivFooter=document.getElementById("chatplusfooter"),"update-user-callback"==a.data.t?_chatplusscript_updateUser_callback&&(_chatplusscript_updateUser_callback.call(this,a.data.response),_chatplusscript_updateUser_callback=null):"get-lead-one-callback"==a.data.t?_chatplusscript_getLeadOne_callback&&(_chatplusscript_getLeadOne_callback.call(this,a.data.response),_chatplusscript_getLeadOne_callback=null):"get-visitor-option-callback"===a.data.t?window.chatplus.option=a.data.response:"va"==a.data.t&&__cp_tracker.ajax(__cp_d+"/api/chat/design/"+__cp_c,{},function(e){if(!(e=JSON.parse(e)).reject){loadStartChat({configKey:a.data.data,configChat:e.data.chat_config,style:e.data.style,version:e.data.version}),a.data.ctoken&&__cp_tracker.getCookie("jp_chatplus_vtoken")!=a.data.ctoken&&__cp_tracker.setCookie("jp_chatplus_vtoken",a.data.ctoken);var t=a.data.via;__cp_vi=t,__cp_tracker.ajax(__cp_d+"/api/lead/startup",{key:__cp_c,page:encodeURIComponent(location.protocol+"//"+location.host+location.pathname+location.search),a:t,p:__cp_p},function(e){if((e=JSON.parse(e)).data.leavepage?localStorage?localStorage.setItem("lead_on_leavepage",e.data.leavepage):__cp_tracker.setCookie("lead_on_leavepage",e.data.leavepage):localStorage?localStorage.setItem("lead_on_leavepage",null):__cp_tracker.setCookie("lead_on_leavepage",null),1==e.result&&e.data.display){var n=e.data.time,t=e.data.leavepage;__cp_tracker.ajax(__cp_d+"/api/lead/config",{key:__cp_c},function(e){if(1==(e=JSON.parse(e)).result&&(1!=e.data.startup.hiddenType||"1"!=__cp_tracker.getCookie("ever"+__cp_c))&&!(2==e.data.startup.hiddenType&&"1"==__cp_tracker.getCookie("display"+__cp_c)||4==e.data.startup.hiddenType&&"1"==__cp_tracker.getCookie("close"+__cp_c)))if((__cp_design=e.data.appearance).checkbox=1==e.data.startup.hiddenType,t)__cp_tracker.readyLead(),localStorage?localStorage.setItem("hiddenType",e.data.startup.hiddenType):__cp_tracker.setCookie("hiddenType",e.data.startup.hiddenType);else{__cp_tracker.readyLead();var a=window.setInterval(function(e){var t=(new Date).getTime()-e.accessTime;t=Math.floor(t/1e3),n<=t&&0==jQueryPlus('form[name="lead_form"]').length&&(__cp_tracker.displayLead(),__cp_tracker.setCookie("display"+__cp_c,"1"),clearInterval(a))},200,__cp_tracker)}})}})}})},!1),function(e,t,a){var n;t.Fingerprint=((n=function(e){var o,t;o=Array.prototype.forEach,t=Array.prototype.map,this.each=function(e,t,a){if(null!==e)if(o&&e.forEach===o)e.forEach(t,a);else if(e.length===+e.length){for(var n=0,i=e.length;n<i;n++)if(t.call(a,e[n],n,e)==={})return}else for(var r in e)if(e.hasOwnProperty(r)&&t.call(a,e[r],r,e)==={})return},this.map=function(e,n,i){var r=[];return null==e?r:t&&e.map===t?e.map(n,i):(this.each(e,function(e,t,a){r[r.length]=n.call(i,e,t,a)}),r)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)}).prototype={get:function(){var e=[];if(e.push(navigator.userAgent),e.push(navigator.language),e.push(screen.colorDepth),this.screen_resolution){var t=this.getScreenResolution();void 0!==t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!window.indexedDB),document.body?e.push(typeof document.body.addBehavior):e.push("undefined"),e.push(typeof window.openDatabase),e.push(navigator.cpuClass),e.push(navigator.platform),e.push(navigator.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},murmurhash3_32_gc:function(e,t){var a,n,i,r,o,c,s,p;for(a=3&e.length,n=e.length-a,i=t,o=3432918353,c=461845907,p=0;p<n;)s=255&e.charCodeAt(p)|(255&e.charCodeAt(++p))<<8|(255&e.charCodeAt(++p))<<16|(255&e.charCodeAt(++p))<<24,++p,i=27492+(65535&(r=5*(65535&(i=(i^=s=(65535&(s=(s=(65535&s)*o+(((s>>>16)*o&65535)<<16)&4294967295)<<15|s>>>17))*c+(((s>>>16)*c&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(r>>>16)&65535)<<16);switch(s=0,a){case 3:s^=(255&e.charCodeAt(p+2))<<16;case 2:s^=(255&e.charCodeAt(p+1))<<8;case 1:i^=s=(65535&(s=(s=(65535&(s^=255&e.charCodeAt(p)))*o+(((s>>>16)*o&65535)<<16)&4294967295)<<15|s>>>17))*c+(((s>>>16)*c&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return!0}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!0}},isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},getPluginsString:function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")},getIEPluginsString:function(){return window.ActiveXObject?this.map(["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"],function(e){try{return new ActiveXObject(e),e}catch(e){return null}}).join(";"):""},getScreenResolution:function(){return this.screen_orientation?screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height]:[screen.height,screen.width]},getCanvasFingerprint:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),a="http://valve.github.io";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(a,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(a,4,17),e.toDataURL()}},n)}(0,this),__cp_tracker.displayChat();
//# sourceMappingURL=cp.js.map